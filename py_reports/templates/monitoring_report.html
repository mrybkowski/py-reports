{% extends "base.html" %} {% block content %}
<div class="report-content">
  {% if report.main_data.table.rows %}
  <div class="table-container">
    <table class="data-table">
      {% set column_groups = group_columns(config.columns) %} {% for row in
      report.main_data.table.rows %} {% set outer_loop = loop %} {% for
      column_group in column_groups %}
      <!-- Header row for group {{ loop.index }} -->
      <thead>
        <tr
          class="header-row-{{ loop.index }} {% if outer_loop.index > 1 %}header-repeat{% endif %}"
        >
          {% for column in column_group %}
          <th
            class="text-{{ column.align | default('left') }}"
            style="width: {{ column.width | default('auto') }};"
          >
            {{ t(column.label_key) if column.label_key else column.label }}
          </th>
          {% endfor %}
        </tr>
      </thead>
      <!-- Data row for group {{ loop.index }} -->
      <tbody>
        <tr class="monitoring-row data-row-{{ loop.index0 }}">
          {% for column in column_group %}
          <td
            class="text-{{ column.align }}"
            style="width: {{ column.width | default('auto') }};"
          >
            {% set cell_data = row[column.field] %} {% if
            cell_data.formatted_value %} {% if column.name == "LP" %}
            <span class="monitoring-lp">{{ cell_data.formatted_value }}</span>
            {% elif column.name == "PersonId" %}
            <span class="monitoring-person-id"
              >{{ cell_data.formatted_value }}</span
            >
            {% elif column.name == "PersonNID" %}
            <span class="monitoring-person-nid"
              >{{ cell_data.formatted_value }}</span
            >
            {% elif column.name == "IsStationary" %}
            <span class="monitoring-stationary">
              {% if cell_data.formatted_value == "True" or
              cell_data.formatted_value == "true" %} {{ t('common.yes') }} {%
              else %} {{ t('common.no') }} {% endif %}
            </span>
            {% elif column.name == "Zones" %}
            <div class="monitoring-zones">{{ cell_data.formatted_value }}</div>
            {% elif column.name == "MonitoringStart" %}
            <span class="monitoring-start"
              >{{ cell_data.formatted_value }}</span
            >
            {% elif column.name == "PlannedEnd" %}
            <span class="monitoring-end">{{ cell_data.formatted_value }}</span>
            {% elif column.name == "Duration" %}
            <span class="monitoring-duration"
              >{{ cell_data.formatted_value }}</span
            >
            {% elif column.name == "Status" %}
            <span class="monitoring-status"
              >{{ cell_data.formatted_value }}</span
            >
            {% elif column.name == "Notes" %}
            <span class="monitoring-notes"
              >{{ cell_data.formatted_value }}</span
            >
            {% elif column.name == "EmptyColumn" %}
            <span class="monitoring-empty"
              >{{ cell_data.formatted_value or "â€”" }}</span
            >
            {% else %}
            <span class="monitoring-field"
              >{{ cell_data.formatted_value }}</span
            >
            {% endif %} {% else %}
            <span class="text-muted">{{ t('common.no_data') }}</span>
            {% endif %}
          </td>
          {% endfor %}
        </tr>
      </tbody>
      {% endfor %} {% endfor %}
    </table>
  </div>
  {% else %}
  <p class="no-data">{{ t('monitoring.no_data') }}</p>
  {% endif %}

  <div class="totals mt-5">
    <h2>{{ t('monitoring.totals.title') }}</h2>
    <table>
      <tr>
        <td>{{ t('monitoring.totals.total_monitoring') }}:</td>
        <td>{{ report.main_data.summary.total_monitoring }}</td>
      </tr>
      <tr>
        <td>{{ t('monitoring.totals.stationary_count') }}:</td>
        <td>{{ report.main_data.summary.stationary_count }}</td>
      </tr>
      <tr>
        <td>{{ t('monitoring.totals.mobile_count') }}:</td>
        <td>{{ report.main_data.summary.mobile_count }}</td>
      </tr>
    </table>
  </div>
</div>
{% endblock %}
